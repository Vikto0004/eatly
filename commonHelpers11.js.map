{"version":3,"file":"commonHelpers11.js","sources":["../src/js/create-account.js"],"sourcesContent":["import $ from 'jquery';\nimport 'jquery-validation';\nimport { receivingDataUser, savingDataUser } from './mockapi';\n\nconst elSignUpEmail = document.querySelector('.sign-up-email');\n\n$(document).ready(function () {\n  $('#sign-up-form').validate({\n    rules: {\n      name: {\n        required: true,\n        minlength: 4,\n      },\n      email: {\n        required: true,\n        email: true,\n      },\n      password: {\n        required: true,\n        minlength: 6,\n      },\n    },\n    messages: {\n      name: {\n        required: 'Please enter your name',\n        minlength: 'Your name must consist of at least 2 characters',\n      },\n      email: {\n        required: 'Please enter your email',\n        email: 'Please enter a valid email address',\n      },\n      password: {\n        required: 'Please enter your password',\n        minlength: 'Your password must be at least 6 characters long',\n      },\n    },\n    highlight: function (element) {\n      $(element).addClass('sign-input-error');\n    },\n    unhighlight: function (element) {\n      $(element).removeClass('sign-input-error');\n    },\n    submitHandler: function (form) {\n      const userName = form.elements.name.value;\n      const userEmail = form.elements.email.value;\n      const userPass = form.elements.password.value;\n\n      checkUserInBaseData(userEmail, userName, userPass);\n    },\n  });\n});\n\nfunction checkUserInBaseData(userEmail, userName, userPass) {\n  receivingDataUser()\n    .then(data => {\n      const res = data.find(({ email }) => email === userEmail);\n      if (res) {\n        const leLabel =\n          '<label class=\"error\" for=\"email\">This email is registered</label>';\n        elSignUpEmail.classList.add('sign-input-error');\n        elSignUpEmail.insertAdjacentHTML('afterend', leLabel);\n\n        elSignUpEmail.addEventListener('input', e => {\n          const elLableErr = e.target.nextElementSibling;\n          elLableErr.style.display = 'none';\n        });\n      } else {\n        savingUserData(userEmail, userName, userPass);\n      }\n    })\n    .catch(error => console.log(error));\n}\n\nasync function savingUserData(userEmail, userName, userPass) {\n  const userData = {\n    name: userName,\n    email: userEmail,\n  };\n  localStorage.setItem('userData', JSON.stringify(userData));\n\n  await savingDataUser({\n    name: userName,\n    email: userEmail,\n    password: userPass,\n  });\n  window.location.href = './';\n}\n"],"names":["elSignUpEmail","$","element","form","userName","userEmail","userPass","checkUserInBaseData","receivingDataUser","data","email","leLabel","e","elLableErr","savingUserData","error","userData","savingDataUser"],"mappings":"gMAIA,MAAMA,EAAgB,SAAS,cAAc,gBAAgB,EAE7DC,EAAE,QAAQ,EAAE,MAAM,UAAY,CAC5BA,EAAE,eAAe,EAAE,SAAS,CAC1B,MAAO,CACL,KAAM,CACJ,SAAU,GACV,UAAW,CACZ,EACD,MAAO,CACL,SAAU,GACV,MAAO,EACR,EACD,SAAU,CACR,SAAU,GACV,UAAW,CACZ,CACF,EACD,SAAU,CACR,KAAM,CACJ,SAAU,yBACV,UAAW,iDACZ,EACD,MAAO,CACL,SAAU,0BACV,MAAO,oCACR,EACD,SAAU,CACR,SAAU,6BACV,UAAW,kDACZ,CACF,EACD,UAAW,SAAUC,EAAS,CAC5BD,EAAEC,CAAO,EAAE,SAAS,kBAAkB,CACvC,EACD,YAAa,SAAUA,EAAS,CAC9BD,EAAEC,CAAO,EAAE,YAAY,kBAAkB,CAC1C,EACD,cAAe,SAAUC,EAAM,CAC7B,MAAMC,EAAWD,EAAK,SAAS,KAAK,MAC9BE,EAAYF,EAAK,SAAS,MAAM,MAChCG,EAAWH,EAAK,SAAS,SAAS,MAExCI,EAAoBF,EAAWD,EAAUE,CAAQ,CAClD,CACL,CAAG,CACH,CAAC,EAED,SAASC,EAAoBF,EAAWD,EAAUE,EAAU,CAC1DE,EAAmB,EAChB,KAAKC,GAAQ,CAEZ,GADYA,EAAK,KAAK,CAAC,CAAE,MAAAC,KAAYA,IAAUL,CAAS,EAC/C,CACP,MAAMM,EACJ,oEACFX,EAAc,UAAU,IAAI,kBAAkB,EAC9CA,EAAc,mBAAmB,WAAYW,CAAO,EAEpDX,EAAc,iBAAiB,QAASY,GAAK,CAC3C,MAAMC,EAAaD,EAAE,OAAO,mBAC5BC,EAAW,MAAM,QAAU,MACrC,CAAS,CACT,MACQC,EAAeT,EAAWD,EAAUE,CAAQ,CAEpD,CAAK,EACA,MAAMS,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtC,CAEA,eAAeD,EAAeT,EAAWD,EAAUE,EAAU,CAC3D,MAAMU,EAAW,CACf,KAAMZ,EACN,MAAOC,CACX,EACE,aAAa,QAAQ,WAAY,KAAK,UAAUW,CAAQ,CAAC,EAEzD,MAAMC,EAAe,CACnB,KAAMb,EACN,MAAOC,EACP,SAAUC,CACd,CAAG,EACD,OAAO,SAAS,KAAO,IACzB"}